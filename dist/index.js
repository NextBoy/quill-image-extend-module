!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.quillImageExtendModule=t():e.quillImageExtendModule=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=0)}([function(e,t,i){"use strict";function n(){var e=document.querySelector(".quill-image-input");null===e&&((e=document.createElement("input")).setAttribute("type","file"),e.classList.add("quill-image-input"),e.style.display="none",e.addEventListener("change",function(){var t=r.active;t.file=e.files[0],e.value="",t.config.size&&t.file.size>=1024*t.config.size*1024?t.config.sizeError&&t.config.sizeError():t.config.action?t.uploadImg():t.toBase64()}),document.body.appendChild(e)),e.click()}i.r(t);var r={watcher:{},active:null,on:function(e,t){this.watcher[e]||(this.watcher[e]=t)},emit:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.active=this.watcher[e],1===t&&n()}};function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=Math.random(),this.quill=t,this.quill.id=this.id,this.config=i,this.file="",this.imgURL="",t.root.addEventListener("paste",this.pasteHandle.bind(this),!1),t.root.addEventListener("drop",this.dropHandle.bind(this),!1),t.root.addEventListener("dropover",function(e){e.preventDefault()},!1),this.cursorIndex=0,r.on(this.id,this)}return function(e,t,i){t&&o(e.prototype,t),i&&o(e,i)}(e,[{key:"pasteHandle",value:function(e){r.emit(this.quill.id,0);var t,i,n,o=e.clipboardData,a=0;if(o){if(!(t=o.items))return;for(i=t[0],n=o.types||[];a<n.length;a++)if("Files"===n[a]){i=t[a];break}if(i&&"file"===i.kind&&i.type.match(/^image\//i)){this.file=i.getAsFile();if(this.config.size&&this.file.size>=1024*this.config.size*1024)return void(this.config.sizeError&&this.config.sizeError());this.config.action?this.uploadImg():this.toBase64()}}}},{key:"dropHandle",value:function(e){r.emit(this.quill.id,0);e.preventDefault(),this.config.size&&this.file.size>=1024*this.config.size*1024?this.config.sizeError&&this.config.sizeError():(this.file=e.dataTransfer.files[0],this.config.action?this.uploadImg():this.toBase64())}},{key:"toBase64",value:function(){var e=this,t=new FileReader;t.onload=function(t){e.imgURL=t.target.result,e.insertImg()},t.readAsDataURL(e.file)}},{key:"uploadImg",value:function(){var e=this,t=(e.quillLoading,e.config),i=new FormData;i.append(t.name,e.file),t.editForm&&t.editForm(i);var n=new XMLHttpRequest;n.open("post",t.action,!0),t.headers&&t.headers(n),t.change&&t.change(n,i),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var i=JSON.parse(n.responseText);e.imgURL=t.response(i),r.active.uploadSuccess(),e.insertImg(),e.config.success&&e.config.success()}else e.config.error&&e.config.error(),r.active.uploadError()},n.upload.onloadstart=function(e){r.active.uploading(),t.start&&t.start()},n.upload.onprogress=function(e){var t=(e.loaded/e.total*100|0)+"%";r.active.progress(t)},n.upload.onerror=function(e){r.active.uploadError(),t.error&&t.error()},n.upload.onloadend=function(e){t.end&&t.end()},n.send(i)}},{key:"insertImg",value:function(){var e=r.active;e.quill.insertEmbed(r.active.cursorIndex,"image",e.imgURL),e.quill.update(),e.quill.setSelection(e.cursorIndex+1)}},{key:"progress",value:function(e){e="[uploading"+e+"]",r.active.quill.root.innerHTML=r.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,e)}},{key:"uploading",value:function(){var e=(r.active.quill.getSelection()||{}).index||r.active.quill.getLength();r.active.cursorIndex=e,r.active.quill.insertText(r.active.cursorIndex,"[uploading...]",{color:"red"},!0)}},{key:"uploadError",value:function(){r.active.quill.root.innerHTML=r.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}},{key:"uploadSuccess",value:function(){r.active.quill.root.innerHTML=r.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}]),e}(),l=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]];i.d(t,"QuillWatch",function(){return r}),i.d(t,"ImageExtend",function(){return a}),i.d(t,"imgHandler",function(){return n}),i.d(t,"container",function(){return l})}])});
//# sourceMappingURL=index.js.map