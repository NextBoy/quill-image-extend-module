!function(e){function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}var t={};i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="/dist/",i(i.s=0)}([function(e,i,t){"use strict";function n(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function r(){var e=document.querySelector(".quill-image-input");null===e&&(e=document.createElement("input"),e.setAttribute("type","file"),e.classList.add("quill-image-input"),e.style.display="none",e.addEventListener("change",function(){var i=a.active;if(i.file=e.files[0],e.value="",i.config.size&&i.file.size>=1024*i.config.size*1024)return void(i.config.sizeError&&i.config.sizeError());i.config.action?i.uploadImg():i.toBase64()}),document.body.appendChild(e)),e.click()}Object.defineProperty(i,"__esModule",{value:!0}),t.d(i,"QuillWatch",function(){return a}),t.d(i,"ImageExtend",function(){return l}),i.imgHandler=r,t.d(i,"container",function(){return u});var o=function(){function e(e,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}}(),a={watcher:{},active:null,on:function(e,i){this.watcher[e]||(this.watcher[e]=i)},emit:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.active=this.watcher[e],1===i&&r()}},l=function(){function e(i){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e),this.id=Math.random(),this.quill=i,this.quill.id=this.id,this.config=t,this.file="",this.imgURL="",i.root.addEventListener("paste",this.pasteHandle.bind(this),!1),i.root.addEventListener("drop",this.dropHandle.bind(this),!1),i.root.addEventListener("dropover",function(e){e.preventDefault()},!1),this.cursorIndex=0,a.on(this.id,this)}return o(e,[{key:"pasteHandle",value:function(e){a.emit(this.quill.id,0);var i=e.clipboardData,t=0,n=void 0,r=void 0,o=void 0;if(i){if(!(n=i.items))return;for(r=n[0],o=i.types||[];t<o.length;t++)if("Files"===o[t]){r=n[t];break}if(r&&"file"===r.kind&&r.type.match(/^image\//i)){this.file=r.getAsFile();var l=this;if(l.config.size&&l.file.size>=1024*l.config.size*1024)return void(l.config.sizeError&&l.config.sizeError());this.config.action}}}},{key:"dropHandle",value:function(e){a.emit(this.quill.id,0);var i=this;if(e.preventDefault(),i.config.size&&i.file.size>=1024*i.config.size*1024)return void(i.config.sizeError&&i.config.sizeError());i.file=e.dataTransfer.files[0],this.config.action?i.uploadImg():i.toBase64()}},{key:"toBase64",value:function(){var e=this,i=new FileReader;i.onload=function(i){e.imgURL=i.target.result,e.insertImg()},i.readAsDataURL(e.file)}},{key:"uploadImg",value:function(){var e=this,i=(e.quillLoading,e.config),t=new FormData;t.append(i.name,e.file),i.editForm&&i.editForm(t);var n=new XMLHttpRequest;n.open("post",i.action,!0),i.headers&&i.headers(n),i.change&&i.change(n,t),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t=JSON.parse(n.responseText);e.imgURL=i.response(t),a.active.uploadSuccess(),e.insertImg(),e.config.success&&e.config.success()}else e.config.error&&e.config.error(),a.active.uploadError()},n.upload.onloadstart=function(e){a.active.uploading(),i.start&&i.start()},n.upload.onprogress=function(e){var i=(e.loaded/e.total*100|0)+"%";a.active.progress(i)},n.upload.onerror=function(e){a.active.uploadError(),i.error&&i.error()},n.upload.onloadend=function(e){i.end&&i.end()},n.send(t)}},{key:"insertImg",value:function(){var e=a.active;e.quill.insertEmbed(a.active.cursorIndex,"image",e.imgURL),e.quill.update(),e.quill.setSelection(e.cursorIndex+1)}},{key:"progress",value:function(e){e="[uploading"+e+"]",a.active.quill.root.innerHTML=a.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,e)}},{key:"uploading",value:function(){var e=(a.active.quill.getSelection()||{}).index||a.active.quill.getLength();a.active.cursorIndex=e,a.active.quill.insertText(a.active.cursorIndex,"[uploading...]",{color:"red"},!0)}},{key:"uploadError",value:function(){a.active.quill.root.innerHTML=a.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}},{key:"uploadSuccess",value:function(){a.active.quill.root.innerHTML=a.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}]),e}(),u=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]}]);
//# sourceMappingURL=index.js.map